(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"8AVY":function(e,t,i){"use strict";i.d(t,"a",function(){return n});var o=i("tk/3"),r=i("nS6G"),a=i("fXoL");let n=(()=>{class e{constructor(e){this.http=e,this.baseUrl=r.a.remoteVTHealthcareServiceBaseUrl}getAll(e){return this.http.post(this.baseUrl+"/api/v1/Vehicle/GetAll",e)}getLookup(e){return this.http.get(this.baseUrl+`/api/v1/Vehicle/GetLookup?isActive=${null==e?"":e}`)}}return e.\u0275fac=function(t){return new(t||e)(a.Ub(o.b))},e.\u0275prov=a.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},EdIZ:function(e,t,i){"use strict";i.r(t),i.d(t,"DeliveryNoteModule",function(){return $});var o=i("cNn3"),r=i("gSRN"),a=i("nS6G"),n=i("fXoL"),d=i("8/KI"),s=i("8AVY"),l=i("TScJ"),c=i("xbeL"),b=i("DUwT"),h=i("k8YA"),u=i("WYlB"),p=i("ZzPI"),m=i("w76M"),f=i("6t9p"),g=i("PVOt"),v=i("ofXK");const S=["deliveryDataGrid"];function y(e,t){if(1&e){const e=n.Rb();n.Qb(0,"dx-button",40),n.Xb("onClick",function(){n.pc(e);const t=n.Zb().$implicit;return n.Zb().onDeleteOrder(t.data.id)}),n.Pb()}2&e&&n.fc("useSubmitBehavior",!1)}function x(e,t){if(1&e&&(n.Qb(0,"div"),n.tc(1,y,1,1,"dx-button",39),n.Pb()),2&e){const e=t.$implicit,i=n.Zb();n.Bb(1),n.fc("ngIf",e.data.statusId==i.statusOrder.Waiting)}}function w(e,t){if(1&e){const e=n.Rb();n.Qb(0,"div"),n.Qb(1,"dx-button",40),n.Xb("onClick",function(){n.pc(e);const i=t.$implicit;return n.Zb().onDelete(i.data.id)}),n.Pb(),n.Pb()}2&e&&(n.Bb(1),n.fc("useSubmitBehavior",!1))}const B=function(){return[10,20,50,100,500]};function P(e,t){if(1&e){const e=n.Rb();n.Qb(0,"div"),n.Qb(1,"div",41),n.Nb(2,"div",1),n.Qb(3,"div",2),n.Qb(4,"form",6),n.Xb("submit",function(t){return n.pc(e),n.Zb().onAddOrderToDelivery(t)}),n.Qb(5,"dx-form",42),n.Qb(6,"dxi-item",43),n.Qb(7,"dx-data-grid",44,20),n.Xb("selectedRowKeysChange",function(t){return n.pc(e),n.Zb().selectedOrder=t}),n.Nb(9,"dxo-filter-row",23),n.Nb(10,"dxo-selection",45),n.Nb(11,"dxo-paging",22),n.Nb(12,"dxo-pager",24),n.Nb(13,"dxi-column",46),n.Nb(14,"dxi-column",47),n.Nb(15,"dxi-column",48),n.Nb(16,"dxi-column",49),n.Nb(17,"dxi-column",50),n.Pb(),n.Pb(),n.Qb(18,"dxi-item",51),n.Nb(19,"dx-button",52),n.Pb(),n.Pb(),n.Pb(),n.Pb(),n.Pb(),n.Pb()}if(2&e){const e=n.Zb();n.Bb(5),n.fc("readOnly",!1)("formData",e.deliveryModel)("showColonAfterLabel",!0)("showValidationSummary",!1),n.Bb(2),n.fc("showColumnLines",!1)("remoteOperations",!0)("rowAlternationEnabled",!0)("hoverStateEnabled",!0)("dataSource",e.lookupOrder)("columnAutoWidth",!0)("selectedRowKeys",e.selectedOrder)("showBorders",!0),n.Bb(2),n.fc("visible",!0),n.Bb(2),n.fc("pageSize",20),n.Bb(1),n.fc("showPageSizeSelector",!0)("allowedPageSizes",n.hc(18,B))("showInfo",!0),n.Bb(7),n.fc("useSubmitBehavior",!0)}}const O=function(e){return{items:e,displayExpr:"name",valueExpr:"id",searchEnabled:!0}},N=function(e){return{dataSource:e,displayExpr:"name",valueExpr:"id",searchEnabled:!0}};let T=(()=>{class e{constructor(e,t,i,o,n,d,s){this.messageService=e,this.deliveryServiceProxy=t,this.lookupServiceProxy=i,this.vehicleService=o,this.orderService=n,this.deliveryService=d,this.staffService=s,this.popupAddOrderVisible=!1,this.statusOrder=a.a.StatusOrder,this.delivery=new r.a({load:e=>this.deliveryService.getAll(e.mapFrom())}),this.lookupServiceProxy.orderStatus().subscribe(e=>{this.lookupOrderStatus=e}),this.lookupServiceProxy.deliveryStatus().subscribe(e=>{this.deliveryStatusLookup=e}),this.vehicleService.getLookup(null).subscribe(e=>{this.vehicleLookup=e.result}),this.staffService.getLookup(a.a.EmployeeRole.Shipper).subscribe(e=>{this.lookupShipper=e.result});let l={statuses:[a.a.StatusOrder.Waiting],hasDelivery:!1};this.lookupOrder=new r.a({load:e=>this.orderService.getAllOrder(e.mapFrom(),l)}),this.getScreenGridSize()}ngOnInit(){}getScreenGridSize(e){this.screenHeight=window.innerHeight,this.gridHeight=this.screenHeight-180+"px"}onSelectionChanged(e){if(this.selectedRows&&this.selectedRows[0].id){this.deliveryServiceProxy.get(this.selectedRows[0].id).subscribe(e=>{this.formData=e});var t={deliveryId:this.selectedRows[0].id};this.orders=new r.a({load:e=>this.orderService.getAllOrder(e.mapFrom(),t)})}}clearForm(){this.selectedRows=null,this.formData=new o.v}onFormSubmit(e){e.preventDefault();let t=new o.ab;t.init(this.formData),this.deliveryServiceProxy.update(this.formData.id,t).subscribe(e=>{this.messageService.success("L\u01b0u th\xe0nh c\xf4ng"),this.deliveryDataGrid.instance.refresh()})}onDelete(e){this.messageService.confirmDelete(t=>{t&&this.formData&&this.formData.id&&this.deliveryServiceProxy.delete(e).subscribe(e=>{this.messageService.success("X\xf3a chuy\u1ebfn \u0111i th\xe0nh c\xf4ng."),this.delivery.reload(),this.orders.reload(),this.formData=new o.v},e=>{this.messageService.error(e.error.message?e.error.message:"X\xf3a chuy\u1ebfn \u0111i kh\xf4ng th\xe0nh c\xf4ng")})})}showPopupAddOrder(e){this.popupAddOrderVisible=!0,this.lookupOrder.reload()}onAddOrderToDelivery(e){if(e.preventDefault(),!this.selectedOrder)return void this.messageService.error("Vui l\xf2ng ch\u1ecdn \xedt nh\u1ea5t 1 \u0111\u01a1n h\xe0ng");let t=new o.ab;t.orderIds=this.selectedOrder.map(e=>e.id),this.deliveryService.addOrderShipment(this.selectedRows[0].id,t).subscribe(e=>{this.messageService.success("Th\xeam m\u1edbi \u0111\u01a1n h\xe0ng v\xe0o chuy\u1ebfn \u0111i th\xe0nh c\xf4ng"),this.popupAddOrderVisible=!1,this.orders.reload()},e=>{this.messageService.error(e.error.message?e.error.message:"Th\xeam m\u1edbi kh\xf4ng th\xe0nh c\xf4ng")})}onDeleteOrder(e){this.messageService.confirmDelete(t=>{t&&this.formData&&this.formData.id&&this.deliveryService.RemoveOrder(this.formData.id,e).subscribe(e=>{this.messageService.success("X\xf3a th\xe0nh c\xf4ng."),this.orders.reload()},e=>{this.messageService.error(e.error.message?e.error.message:"X\xf3a kh\xf4ng th\xe0nh c\xf4ng")})})}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(d.a),n.Mb(o.s),n.Mb(o.E),n.Mb(s.a),n.Mb(l.a),n.Mb(c.a),n.Mb(b.a))},e.\u0275cmp=n.Gb({type:e,selectors:[["app-delivery-note-list"]],viewQuery:function(e,t){if(1&e&&n.zc(S,1),2&e){let e;n.lc(e=n.Yb())&&(t.deliveryDataGrid=e.first)}},hostBindings:function(e,t){1&e&&n.Xb("resize",function(e){return t.getScreenGridSize(e)},!1,n.oc)},decls:56,vars:76,consts:[[1,"card","custom-card",2,"margin-bottom","5px"],[1,"card-header"],[1,"card-body"],[3,"readOnly","formData","showColonAfterLabel","showValidationSummary"],["itemType","group","caption","",3,"colCount"],["itemType","group","caption","Th\xf4ng tin ch\xednh",3,"colSpan"],["action","",3,"submit"],["validationGroup","shipmentForm",3,"readOnly","formData","showColonAfterLabel","showValidationSummary"],["itemType","group","caption",""],["dataField","name",3,"colSpan"],[3,"text"],["type","required","message","Tr\u01b0\u1eddng n\xe0y l\xe0 b\u1eaft bu\u1ed9c"],["type","stringLength","message","H\u1ecd t\xean kh\xf4ng v\u01b0\u1ee3t qu\xe1 300 k\xfd t\u1ef1",3,"max"],["editorType","dxSelectBox","dataField","vehicleId",3,"colSpan","editorOptions"],["editorType","dxSelectBox","dataField","shipperId",3,"colSpan","editorOptions"],["editorType","dxTagBox","dataField","supportShippers",3,"colSpan","editorOptions"],["text","L\u01b0u","type","success","icon","fa fa-floppy-o","validationGroup","shipmentForm",2,"float","right",3,"useSubmitBehavior","disabled"],["itemType","group","caption","Danh s\xe1ch \u0111\u01a1n h\xe0ng"],["text","Th\xeam m\u1edbi \u0111\u01a1n h\xe0ng cho chuy\u1ebfn \u0111i","type","success","icon","fa fa-floppy-o",2,"margin-right","10px","background-color","#12007c","font-weight","bold","padding","2px",3,"disabled","onClick"],[3,"showColumnLines","remoteOperations","rowAlternationEnabled","hoverStateEnabled","dataSource","columnAutoWidth","showBorders"],["orderDataGrid",""],["mode","single"],[3,"pageSize"],[3,"visible"],[3,"showPageSizeSelector","allowedPageSizes","showInfo"],["dataField","codeDeliveryBill","caption","Phi\u1ebfu xu\u1ea5t kho","sortOrder","desc"],["dataField","statusId",3,"caption"],["valueExpr","id","displayExpr","name",3,"dataSource"],["dataField","orderTime","caption","Ng\xe0y \u0111\u1eb7t h\xe0ng","dataType","date","format","dd/MM/yyyy HH:mm"],["dataField","estimateTime","caption","Giao h\xe0ng d\u1ef1 ki\u1ebfn","dataType","date","format","dd/MM/yyyy HH:mm"],["dataField","price","caption","Gi\xe1 \u0111\u01a1n h\xe0ng","alignment","center","format","#,##0"],["dataField","id","caption","T\xf9y ch\u1ec9nh","alignment","left","cellTemplate","cellTemplate",3,"allowFiltering","allowSorting"],[4,"dxTemplate","dxTemplateOf"],["itemType","group","caption","Danh s\xe1ch chuy\u1ebfn \u0111i",3,"colSpan"],[3,"height","showColumnLines","remoteOperations","rowAlternationEnabled","selectedRowKeys","hoverStateEnabled","dataSource","columnAutoWidth","showBorders","heightChange","selectedRowKeysChange","onSelectionChanged"],["deliveryDataGrid",""],["dataField","name","caption","T\xean"],["dataField","vehicle","caption","Ph\u01b0\u01a1ng ti\u1ec7n"],["width","60%","height","auto","title","T\u1ea1o chuy\u1ebfn \u0111i",3,"showTitle","dragEnabled","closeOnOutsideClick","visible","visibleChange"],["icon","fa fa-trash","text","X\xf3a","style","background-color: #ff000f;","type","success",3,"useSubmitBehavior","onClick",4,"ngIf"],["icon","fa fa-trash","text","X\xf3a","type","success",2,"background-color","#ff000f",3,"useSubmitBehavior","onClick"],[1,"card"],["id","form",3,"readOnly","formData","showColonAfterLabel","showValidationSummary"],["itemType","group","caption","Ch\u1ecdn chuy\u1ebfn \u0111i"],[3,"showColumnLines","remoteOperations","rowAlternationEnabled","hoverStateEnabled","dataSource","columnAutoWidth","selectedRowKeys","showBorders","selectedRowKeysChange"],["mode","multiple"],["dataField","codeDeliveryBill","caption","Phi\u1ebfu xu\u1ea5t kho"],["dataField","statusName","caption","Tr\u1ea1ng th\xe1i"],["dataField","orderTime","caption","Ng\xe0y \u0111\u1eb7t h\xe0ng","dataType","date","format","dd/MM/yyyy HH:mm","sortOrder","desc"],["dataField","price","caption","Gi\xe1 \u0111\u01a1n","alignment","center","format","#,##0"],["dataField","vehicleName","caption","Ph\u01b0\u01a1ng ti\u1ec7n","alignment","center"],["itemType","group","caption","",2,"text-align-last","end"],["icon","fa fa-floppy-o","text","Th\xeam \u0111\u01a1n h\xe0ng","type","success",2,"margin-right","10px",3,"useSubmitBehavior"]],template:function(e,t){1&e&&(n.Qb(0,"div",0),n.Nb(1,"div",1),n.Qb(2,"div",2),n.Qb(3,"dx-form",3),n.Qb(4,"dxi-item",4),n.Qb(5,"dxi-item",5),n.Qb(6,"form",6),n.Xb("submit",function(e){return t.onFormSubmit(e)}),n.Qb(7,"dx-form",7),n.Qb(8,"dxi-item",8),n.Qb(9,"dxi-item",4),n.Qb(10,"dxi-item",9),n.Nb(11,"dxo-label",10),n.Nb(12,"dxi-validation-rule",11),n.Nb(13,"dxi-validation-rule",12),n.Pb(),n.Qb(14,"dxi-item",13),n.Nb(15,"dxo-label",10),n.Nb(16,"dxi-validation-rule",11),n.Pb(),n.Qb(17,"dxi-item",14),n.Nb(18,"dxo-label",10),n.Nb(19,"dxi-validation-rule",11),n.Pb(),n.Qb(20,"dxi-item",15),n.Nb(21,"dxo-label",10),n.Pb(),n.Pb(),n.Qb(22,"dxi-item",8),n.Nb(23,"dx-button",16),n.Pb(),n.Qb(24,"dxi-item",17),n.Qb(25,"dxi-item",4),n.Qb(26,"dx-button",18),n.Xb("onClick",function(e){return t.showPopupAddOrder(e)}),n.Pb(),n.Pb(),n.Qb(27,"dx-data-grid",19,20),n.Nb(29,"dxo-selection",21),n.Nb(30,"dxo-paging",22),n.Nb(31,"dxo-header-filter",23),n.Nb(32,"dxo-filter-row",23),n.Nb(33,"dxo-pager",24),n.Nb(34,"dxi-column",25),n.Qb(35,"dxi-column",26),n.Nb(36,"dxo-lookup",27),n.Pb(),n.Nb(37,"dxi-column",28),n.Nb(38,"dxi-column",29),n.Nb(39,"dxi-column",30),n.Nb(40,"dxi-column",31),n.tc(41,x,2,1,"div",32),n.Pb(),n.Pb(),n.Pb(),n.Pb(),n.Pb(),n.Pb(),n.Qb(42,"dxi-item",33),n.Qb(43,"dxi-item",8),n.Qb(44,"dx-data-grid",34,35),n.Xb("heightChange",function(e){return t.gridHeight=e})("selectedRowKeysChange",function(e){return t.selectedRows=e})("onSelectionChanged",function(e){return t.onSelectionChanged(e)}),n.Nb(46,"dxo-selection",21),n.Nb(47,"dxo-paging",22),n.Nb(48,"dxo-pager",24),n.Nb(49,"dxo-header-filter",23),n.Nb(50,"dxi-column",36),n.Nb(51,"dxi-column",37),n.Nb(52,"dxi-column",31),n.tc(53,w,2,1,"div",32),n.Pb(),n.Pb(),n.Pb(),n.Pb(),n.Pb(),n.Pb(),n.Pb(),n.Qb(54,"dx-popup",38),n.Xb("visibleChange",function(e){return t.popupAddOrderVisible=e}),n.tc(55,P,20,19,"div",32),n.Pb()),2&e&&(n.Bb(3),n.fc("readOnly",!1)("formData",t)("showColonAfterLabel",!0)("showValidationSummary",!1),n.Bb(1),n.fc("colCount",4),n.Bb(1),n.fc("colSpan",2),n.Bb(2),n.fc("readOnly",!1)("formData",t.formData)("showColonAfterLabel",!0)("showValidationSummary",!1),n.Bb(2),n.fc("colCount",4),n.Bb(1),n.fc("colSpan",2),n.Bb(1),n.fc("text","T\xean"),n.Bb(2),n.fc("max",300),n.Bb(1),n.fc("colSpan",2)("editorOptions",n.ic(68,O,t.vehicleLookup)),n.Bb(1),n.fc("text","Ph\u01b0\u01a1ng ti\u1ec7n"),n.Bb(2),n.fc("colSpan",2)("editorOptions",n.ic(70,O,t.lookupShipper)),n.Bb(1),n.fc("text","Shipper"),n.Bb(2),n.fc("colSpan",2)("editorOptions",n.ic(72,N,t.lookupShipper)),n.Bb(1),n.fc("text","Shipper h\u1ed7 tr\u1ee3"),n.Bb(2),n.fc("useSubmitBehavior",!0)("disabled",!t.selectedRows),n.Bb(2),n.fc("colCount",2),n.Bb(1),n.fc("disabled",!t.selectedRows),n.Bb(1),n.fc("showColumnLines",!1)("remoteOperations",!0)("rowAlternationEnabled",!0)("hoverStateEnabled",!0)("dataSource",t.orders)("columnAutoWidth",!0)("showBorders",!0),n.Bb(3),n.fc("pageSize",20),n.Bb(1),n.fc("visible",!0),n.Bb(1),n.fc("visible",!0),n.Bb(1),n.fc("showPageSizeSelector",!0)("allowedPageSizes",n.hc(74,B))("showInfo",!0),n.Bb(2),n.fc("caption","Tr\u1ea1ng th\xe1i"),n.Bb(1),n.fc("dataSource",t.lookupOrderStatus),n.Bb(4),n.fc("allowFiltering",!1)("allowSorting",!1),n.Bb(1),n.fc("dxTemplateOf","cellTemplate"),n.Bb(1),n.fc("colSpan",2),n.Bb(2),n.fc("height",t.gridHeight)("showColumnLines",!1)("remoteOperations",!0)("rowAlternationEnabled",!0)("selectedRowKeys",t.selectedRows)("hoverStateEnabled",!0)("dataSource",t.delivery)("columnAutoWidth",!0)("showBorders",!0),n.Bb(3),n.fc("pageSize",5),n.Bb(1),n.fc("showPageSizeSelector",!0)("allowedPageSizes",n.hc(75,B))("showInfo",!0),n.Bb(1),n.fc("visible",!0),n.Bb(3),n.fc("allowFiltering",!1)("allowSorting",!1),n.Bb(1),n.fc("dxTemplateOf","cellTemplate"),n.Bb(1),n.fc("showTitle",!0)("dragEnabled",!1)("closeOnOutsideClick",!0)("visible",t.popupAddOrderVisible),n.Bb(1),n.fc("dxTemplateOf","content"))},directives:[h.a,f.k,f.lb,f.A,u.a,p.a,f.Hb,f.yb,f.fb,f.W,f.wb,f.f,f.ob,g.d,m.a,v.j],styles:[""]}),e})();var k=i("tyNb");const D=[{path:"",redirectTo:"list",pathMatch:"prefix"},{path:"",component:(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Gb({type:e,selectors:[["app-delivery-note"]],decls:1,vars:0,template:function(e,t){1&e&&n.Nb(0,"router-outlet")},directives:[k.g],styles:[""]}),e})(),children:[{path:"list",component:T}]}];let Q=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.Kb({type:e}),e.\u0275inj=n.Jb({imports:[[k.f.forChild(D)],k.f]}),e})();var A=i("7m6G"),C=i("4Ewp"),F=i("Wx6Q"),E=i("Qlw+"),L=i("gMzk"),R=i("Gkpw"),G=i("uTW7"),I=i("ir3x"),z=i("M+dh"),X=i("LT8A"),M=i("zn50"),V=i("BbNB"),H=i("xcIV"),K=i("lgXn"),W=i("Ylls"),Z=i("/ZIY"),Y=i("XPKZ"),U=i("4/q7"),J=i("QE0S");let $=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.Kb({type:e}),e.\u0275inj=n.Jb({imports:[[v.b,Q,u.b,A.a,C.a,F.a,E.a,h.b,L.b,R.b,G.a,I.a,z.a,X.a,M.a,V.a,H.a,g.f,p.b,K.a,m.b,W.a,Z.a,Y.b,U.b,J.b]]}),e})()}}]);